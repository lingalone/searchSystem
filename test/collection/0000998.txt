Optimization of distributed tree queries
