Two algorithms for three-layer channel routing
